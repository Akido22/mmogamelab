<!-- doc.title Настройка имён персонажей в конструкторе онлайн-игр -->
<!-- doc.parent index -->
<!-- doc.keywords имя персонажа, имя, персонаж, онлайн-игра -->
<!-- doc.description Статья о настройке системы имён персонажей в играх на конструкторе онлайн-игр -->

<p>В различных интерфейсах игры имя персонажа необходимо выводить по-разному. Где-то требуется полная версия со всеми регалиями &mdash; с десятком значков до или после ника. Где-то, напротив, нужна только краткая информация &mdash; имя персонажа и его уровень.</p>

<p>Конструктор позволяет администратору игры гибко настраивать отображение имён персонажей в разных местах игры. Доступ к интерфейсу настройки имён персонажей осуществляется через пункт "Персонажи / Имена персонажей": <img class="doc-screenshot" src="/st/tutorial/names-1.png" alt="" /></p>

<p>Шаблон имени позволяет указать спецтеги, которые будут заменены на необходимые строки самим конструктором, а также воспользоваться <a href="/doc/script">скриптовым движком</a> и написать любые нестандартные форматы имён: <img class="doc-screenshot" src="/st/tutorial/names-2.png" alt="" /></p>

<ul>
	<li>{NAME} &mdash; это имя персонажа. В зависимости от контекста оно может выводиться со специальной обработкой. К примеру, если вы формируете HTML-представление имени персонажа для ростера, то {NAME} будет автоматически завёрнуто в HTML-код, делающий имя персонажа кликабельным;</li>
	<li>{INFO} &mdash; это иконка со ссылкой на страницу информации персонажа. Сами иконки настраиваются в разделе "Интерфейс игры / Редактор иконок" (char-male и char-female для мужского и женского значков соответственно);</li>
	<li>{скрипт} &mdash; это любое скриптовое выражение. Если быть точнее, то весь шаблон имени персонажа обрабатывается при помощи парсера строк <a href="/doc/script">скриптового движка</a>, т.е. возможно использовать не только "{скрипт}", но и формат "[скрипт?строка,строка,строка]". К примеру, шаблон со скриншота можно переписать так: <pre class="doc-code-sample">{NAME} {INFO} [{char.p_level}] [char.anyperm:, - админ]</pre></li>
</ul>

<h1>Кэширование имён персонажей</h1>

<p>HTML-представления имён персонажей не вычисляются каждый раз при каждом отображении. Пересчёт (инвалидация кэша) делается только в определённых случаях:</p>

<ul>
	<li>персонаж входит в игру;</li>
	<li>персонаж выходит из игры;</li>
	<li>персонаж переходит в другую локацию;</li>
	<li>изменяется какой-то сохраняемый параметр персонажа;</li>
	<li>персонажу изменяют имя;</li>
	<li>персонажу выдают или отнимают доступ.</li>
</ul>

<h1>Примеры использования скриптов в именах</h1>

<ul>
	<li>Выделение администратора (у кого есть хотя бы одна привилегия) специальной пометкой: <pre class="doc-code-sample">{NAME} {INFO} [char.anyperm:, - админ]</pre> На месте текста "- админ" можно вставить любой HTML-код, например код картинки иконки администратора</li>
	<li>Выделение администратора (у кого есть одна конкретная привилегия, скажем "главный администратор") специальной пометкой: <pre class="doc-code-sample">{NAME} {INFO} [char.perm_project_admin:, - главный админ]</pre></li>
	<li>Отображение уровня персонажа: <pre class="doc-code-sample">{NAME} [{char.p_level}] {INFO}</pre></li>
	<li>Выделение имени персонажа другим стилем: <pre class="doc-code-sample">&lt;span class="char-name"&gt;{NAME}&lt;/span&gt; {INFO}</pre></li>
	<li>Персонажам, находящимся в подземелье, менять цвет ников на красный: <pre class="doc-code-sample">&lt;span style="{char.location.p_dungeon ? "color: red" : ""}"&gt;{NAME}&lt;/span&gt; {INFO}</pre> Чтобы это правило заработало, надо ввести параметр локации "dungeon" и у нужных локаций прописать его значение "1".</li>
</ul>

<h1>Дополнительно</h1>
<ul>
	<li><a href="/doc/parameters">Настройка системы параметров</a></li>
	<li><a href="/doc/script">Описание скриптового языка конструктора</a></li>
</ul>
