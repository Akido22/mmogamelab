<!-- doc.title Настройка параметров объектов в MMO Constructor -->
<!-- doc.parent index -->
<!-- doc.keywords параметры персонажа, параметры в онлайн-игре, параметры локаций, настройка параметров персонажа -->
<!-- doc.description Статья о настройке параметров различных объектов в конструкторе онлайн-игр MMO Constructor -->

<p>В разных играх набор параметров у персонажей, локаций, зданий и других объектов различен. Администратор игры имеет возможность гибко настраивать систему параметров &mdash; задавать формулы, вычисляющие параметры, скрывать и показывать различные параметры от игроков. Кроме того, предоставляется дополнительный сервис по автоматической генерации описаний параметров для библиотеки.</p>

<p>Эта статья далее описывает настройку параметров персонажей. Для других объектов настройки производятся аналогичным образом.</p>

<h1>Редактор параметров</h1>

<p>Доступ к редактору параметров осуществляется через меню "Персонажи / Параметры персонажей". Откроется список уже существующих параметров: <img class="doc-screenshot" src="/st/tutorial/params-1.png" alt="" /></p>

<p>Создавая новый параметр или редактируя уже существующий, вы увидите большую форму, разделённую на несколько разделов. Каждый из разделов отвечает за определённую функциональность параметра.</p>

<h2>Основные свойства</h2>

<p>Самый верхний раздел &mdash; основные свойства: <img class="doc-screenshot" src="/st/tutorial/params-2.png" alt="" /></p>
<ul>
	<li>код параметра &mdash; идентификатор параметра, который будет использоваться в скриптах. Идентификатор должен начинаться с латинской буквы или подчёркивания. Остальные символы могут быть латинскими буквами, цифрами и подчёркиваниями;</li>
	<li>название параметра &mdash; текстовое название в том виде, в котором оно будет показываться игрокам;</li>
	<li>галочка "параметр видим владельцу" позволяет скрыть или показать определённый параметр для игрока. Часть параметров в игре может быть скрытой от игроков, например параметр "карма", определяющий соотношение добрых и злых поступков в игре, имеет смысл скрыть, чтобы игрок не знал, достаточно ли он "натворил добра";</li>
	<li>галочка "параметр видим, даже если его значение равно 0" позволяет отображать параметры с нулевым значением, которые по умолчанию скрыты от игроков;</li>
	<li>условие видимости &mdash; позволяет задать выражение на скриптовом языке, определяющее, когда параметр видим игроку, а когда нет. Может быть полезно, чтобы не заваливать новичка огромным количеством пока не нужных ему параметров. К примеру, если написать условие: <pre class="doc-code-sample">char.p_level &gt;= 3</pre>то параметр будет показываться, только если уровень персонажа (параметр "level") 3 или выше;</li>
	<li>описание параметра &mdash; напишите вкратце, как получается этот параметр и на что он влияет. Описание будет опубликовано в библиотеке;</li>
	<li>важный параметр &mdash; это значит, что параметр будет показываться непосредственно при нажатии на кнопку "персонаж". Если в игре много параметров, то часть из них можно пометить как неважные, чтобы не отвлекать игрока от основных параметров. Все остальные можно будет посмотреть по специальной ссылке "Показать параметры персонажа";</li>
	<li>публично видимый &mdash; означает, что значение параметра будет показано на страницы публичной информации персонажа.</li>
</ul>

<h2>Группировка параметра</h2>

<p>Администратор имеет возможность настроить порядок отображения параметров, а также возможность сгруппировать близкие параметры под общим заголовком: <img class="doc-screenshot" src="/st/tutorial/params-3.png" alt="" /></p>
<ul>
	<li>название группы параметра &mdash; это заголовок, который будет выведен перед этим параметром. Если подряд идут несколько параметров с одинаковым названием группы, то название группы будет выведено только один раз &mdash; перед первым параметром;</li>
	<li>порядок сортировки &mdash; это число, определяющее порядок следования параметров. Все параметры выводятся в порядке увеличения "порядка сортировки".</li>
</ul>

<h2>Значения параметров</h2>

<p>Параметры бывают двух основных видов: первичные (это просто числа, сохраняемые в базе данных), и вычисляемые (из нескольких параметров можно по формуле "собрать" новый параметр, значение которого будет автоматически обновляться при изменении компонентов формулы).</p>

<p>Чтобы ввести сохраняемый в базе данных параметр, достаточно выбрать соответствующий пункт в поле "Значение параметра": <img class="doc-screenshot" src="/st/tutorial/params-4.png" alt="" /></p>

<ul>
	<li>значение по умолчанию &mdash; именно это число будет показываться у персонажа, для которого этот параметр ещё ни разу не устанавливался. Если персонаж только что зарегистрировался, то параметр будет равен этому числу. Если вы только что ввели новый параметр, то у всех персонажей его значение будет равно этому числу.</li>
</ul>

<p>Чтобы задать вычисляемый параметр, вам понадобится выбрать соответствующий пункт в поле "Значение параметра": <img class="doc-screenshot" src="/st/tutorial/params-5.png" alt="" /></p>

<ul>
	<li>выражение &mdash; это формула на скриптовом языке, по которой рассчитывание значение параметра. Скажем, если вы хотите ввести параметр "максимальное количество HP" (max_hp) и сделать, чтобы оно зависело, скажем, от уровня персонажа, вы можете написать в поле "выражение", например, такую строку: <pre class="doc-code-sample">90 + char.p_level * 10</pre> Тогда у персонажа 1 уровня будет 100 очков HP, у персонажа 2 уровня &mdash; 110 и т.д.</li>
</ul>

<p>Ещё одна дополнительная возможность для вычисляемых параметров &mdash; задание таблицы пост-обработки. Она будет полезна для того, чтобы удобным образом преобразовывать опыт в уровень персонажа. С каждой строки вы задаёте два значения через двоеточие &mdash; величину опыта и какому уровню она соответствует. На скриншоте приведён пример, как можно описать параметр "уровень персонажа" (level). Движок возьмёт параметр персонажа "опыт" (xp) и по таблице уровней преобразует опыт в уровень: <img class="doc-screenshot" src="/st/tutorial/params-6.png" alt="" /></p>

<p>Разумеется, понимая, как эта возможность устроена, её можно использовать и для каких-то других целей.</p>

<h2>Визуализация параметров</h2>

<p>Значение параметра можно отображать несколькими способами &mdash; просто числом, HTML-строкой по таблице или их комбинацией. Самый простой способ &mdash; это показывать просто число. Если параметр равен 5, то будет показано просто "5": <img class="doc-screenshot" src="/st/tutorial/params-7.png" alt="" /></p>

<p>Если задано количество разрядов после десятичной точки (от 0 до 5), то значение параметра будет принудительно трактоваться как число и отображаться с указанным числом разрядов. Если значение параметра будет не численным, то будет показан 0 с нужным количеством нулей после точки.</p>

<p>Если галочка "показывать знак +" установлена у параметра и если он положительный, то значение будет выводиться со знаком "+". Если галочка не установлена, то положительные значения параметра будут выводиться без плюса.</p>

<p>Второй способ задания отображения &mdash; это задание произвольных HTML-строк. Он будет полезен, если вы хотите показывать параметры типа уровня персонажа не числом, а соответствующей этому числу строкой. Например, если вы делаете военную игру, то звания персонажа лучше показывать текстом, а не числами. В этом случае вы можете задать каждому числовому значению параметра соответствующий текст: <img class="doc-screenshot" src="/st/tutorial/params-8.png" alt="" /></p>

<p>Строки в таблице могут быть не только просто текстовыми, но могут содержать и любой HTML-текст. К примеру, вы можете сделать, чтобы вместо текстовых названий уровней отображались картинки, соответствующие уровню. Для этого пропишите в таблицу полностью код вставки картинки:</p>
<pre class="doc-code-sample">
3: &lt;img src="//storage.mmoconstructor.ru/some/image/level-3.png" alt="[3]" title="3 уровень" /&gt;
</pre>
<p>В приведённом выше примере 3 уровень персонажа будет отображаться в виде: "Уровень: [картинка]". Пока картинка не загрузилась в браузер, игроку будет показываться текст "[3]" (атрибут alt). При наведении мыши на картинку будет всплывать подсказка: "3 уровень" (атрибут title). Загрузить статические картинки вы можете в <a href="/doc/storage">статическое хранилище конструктора</a>.</p>

<p>Третий вариант отображения &mdash; это удобный способ показать и числовое значение параметра, и его HTML-представление. Вы задаёте шаблон и используете в нём специальные команды "{val}" и "{text}". На их место будут подставлены числовое и HTML-значения соответственно: <img class="doc-screenshot" src="/st/tutorial/params-9.png" alt="" /></p>

<p>Если задать такой шаблон, как на скриншоте, то 3-й уровень персонажа будет отображаться в таком виде: "Уровень: 3 &bull; лейтенант". Вы можете выделить число и текст произвольными стилями. В шаблоне допустимо использовать любые HTML-теги. К примеру:</p>
<pre class="doc-code-sample">
&lt;span class="param-value-num"&gt;{val}&lt;/span&gt; &amp;middot; &lt;span class="param-value-text"&gt;{text}&lt;/span&gt;
</pre>

<h2>Настройка отображения в библиотеке</h2>

<p>Конструктор позволяет вам задать для каждого параметра описание и автоматически сформировать страницу библиотеки, описывающую, какие параметры есть у персонажа, как их получить в игре, и на что они влияют. Вы можете индивидуально для каждого параметра настраивать режим его отображения в библиотеке.</p>

<p>Чтобы опубликовать параметр в библиотеке, вам необходимо установить галочку "Публиковать описание параметра в библиотеке": <img class="doc-screenshot" src="/st/tutorial/params-10.png" alt="" /></p>

<p>Когда вы публикуете параметр, рядом с его отображением в интерфейсе пользователя появится значок <img src="/st-mg/icons/library-icon.png" alt="?" /> (который вы, кстати, можете переопределить в разделе "Интерфейс игры / Редактор иконок"). Ссылка на значке будет вести в библиотеку. Если вы хотите, чтобы описание параметра появилось на странице /library/charparams, то установите галочку "Сгенерировать описание для библиотеки автоматически". Если, к примеру, вы самостоятельно создадите страницу библиотеки с описанием, к примеру, системы магии, то, вероятно, вы захотите самостоятельно описать там все магические характеристики персонажа. В этом случае вы можете снять эту галочку и вручную задать URL страницы, на которую должна указывать ссылка с иконки: <img class="doc-screenshot" src="/st/tutorial/params-11.png" alt="" /></p>

<p>Если у вас в свойствах параметра заданы какие-то таблицы (либо таблица значений опыта, либо текстовое отображение значений, либо они вместе), то конструктор может создать отдельную страницу библиотеки и опубликовать на ней эти таблицы. Для этого установите галочку "Публиковать таблицу преобразований в библиотеке". Таблицы будут доступны по адресу "/library/charparam/код-параметра". К примеру, для параметра "level" адрес будет "/library/charparam/level".</p>

<h2>Настройки API</h2>

<p>API игры пока не реализовано, но уже сейчас вы можете задать, какие параметры вы захотите через него выдавать.</p>

<h2>Просмотр параметров через админку</h2>

<p>Администратор может просмотреть все параметры персонажа через вкладку "Параметры" в досье персонажа: <img class="doc-screenshot" src="/st/tutorial/params-12.png" alt="" /></p>

<h1>Дополнительно</h1>
<ul>
	<li><a href="/doc/library">Описание настройки библиотеки</a></li>
	<li><a href="/doc/design/gameinterface">Настройка оформления игры</a></li>
	<li><a href="/doc/design/character-info">Вёрстка страницы информации персонажа</a></li>
	<li><a href="/doc/design/character-page">Вёрстка внутриигровой страницы персонажа</a></li>
        <li><a href="/doc/design/character-params">Вёрстка внутриигровой страницы параметров персонажа</a></li>
        <li><a href="/doc/character-delivery">Доставка параметров персонажей в клиент</a></li>
</ul>
