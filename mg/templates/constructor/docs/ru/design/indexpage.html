<!-- doc.title Оформление титульной страницы онлайн-игры -->
<!-- doc.parent index -->
<!-- doc.keywords титульная страница, онлайн-игра, игра, онлайн, титульная, html -->
<!-- doc.description Как правильно оформлять html-шаблон титульной страницы в онлайн-играх, созданные на основе конструктора игр -->

<h1>Вёрстка титульной страницы в конструкторе онлайн-игр</h1>

<p><a href="/doc/design/templates">Общая информация о HTML-шаблонах в конструкторе</a></p>

<p>Шаблон оформления для титульной страницы игры должен удовлетворять следующим требованиям:</p>

<ul>
	<li>в пакете должен быть ровно один html-файл, и он должен называться index.html;</li>
	<li>в пакете должен быть, как минимум, один css-файл;</li>
	<li>в index.html должна быть форма входа в игру с обязательными атрибутами: &lt;form name="loginform" id="loginform" onsubmit="return auth_login();"&gt;;</li>
	<li>в форме входа в игру должны присутствовать два обязательных поля:<ul>
		<li>&lt;input id="name" name="name"&gt; &mdash; поле для ввода имени персонажа;</li>
		<li>&lt;input id="password" name="password"&gt; &mdash; поле для пароля;</li>
	</ul></li>
	<li>ссылка на регистрацию в игре должна быть оформлена как &lt;a href="javascript:void(0)" onclick="return auth_register();"&gt;;</li>
	<li>ссылка на напоминание пароля должна быть оформлена как &lt;a href="javascript:void(0)" onclick="return auth_remind();"&gt;.</li>
</ul>

<p>На титульной странице игры доступны следующие параметры шаблонизатора:</p>

<ul>
	<li>title &mdash; заголовок страницы;</li>
	<li>game.title_full &mdash; полное название игры;</li>
	<li>game.title_short &mdash; сокращённое название игры;</li>
	<li>game.description &mdash; описание игры;</li>
	<li>news (может отсутствовать) &mdash; список новостей игры. У каждой новости есть параметры:<ul>
		<li>created &mdash; дата создания;</li>
		<li>subject &mdash; тема новости;</li>
		<li>announce &mdash; текст анонса;</li>
		<li>more &mdash; если присутствует, то является ссылкой на полный текст новости;</li>
	</ul></li>
	<li>htmlmeta.description &mdash; описание страницы (для поисковых систем);</li>
	<li>htmlmeta.keywords &mdash; ключевые слова (для поисковых систем);</li>
	<li>head &mdash; произвольный код, который должен быть вставлен в конце раздела &lt;head&gt;;</li>
	<li>year &mdash; текущий год;</li>
	<li>copyright &mdash; имя автора игры;</li>
	<li>links (может отсутствовать) &mdash; список ссылок на ресурсы игры. У каждой ссылки есть параметры:<ul>
		<li>title &mdash; текст ссылки;</li>
		<li>href &mdash; если присутствует, то пункт меню должен содержать ссылку на указанный URL;</li>
		<li>onclick &mdash; если присутствует, то пункт меню должен иметь атрибут onclick с этим текстом;</li>
	</ul></li>
	<li>ratings (может отсутствовать) &mdash; список игровых рейтингов, которые стоит опубликовать на титульной странице. Каждый рейтинг имеет параметры:<ul>
		<li>title &mdash; название рейтинга;</li>
		<li>href &mdash; ссылка на полную версию рейтинга;</li>
		<li>list &mdash; список топ-участников этого рейтинга. Каждый элемент списка имеет параметры:<ul>
			<li>name &mdash; имя участника рейтинга;</li>
			<li>value &mdash; значение параметра рейтинга;</li>
			<li>class &mdash; "rating-even", если участник чётный, и "rating-odd", если нечётный;</li>
		</ul></li>
	</ul></li>
	<li>game_domain &mdash; домен игры.</li>
</ul>

<p>На странице должна присутствовать форма для входа в игру. Форма должна передаваться на адрес "/" и иметь два параметра&nbsp;&mdash; name и password. Поле name предназначено для ввода имени персонажа. Password&nbsp;&mdash; его пароль. Пример формы:</p>

<h1>Вход в игру</h1>

<pre class="doc-code-sample">
&lt;form action="/" method="post" name="loginform"&gt;
	&lt;input name="name" value="" title="Имя персонажа" /&gt;
	&lt;input type="password" name="password" value="" title="Пароль" /&gt;
	&lt;input type="submit" value="Войти в игру" /&gt;
&lt;/form&gt;
</pre>

<a name="reg"></a>
<h1>Регистрация</h1>

<p>На титульной странице должна присутствовать возможность регистрации и восстановления пароля. В код вашей страницы для этого можно либо встроить вызовы auth_register() и auth_remind() соответственно, либо реализовать форму регистрации и напоминания пароля самостоятельно.</p>

<p>Если вы будете реализовывать форму самостоятельно, вам понадобятся данные из глобального JavaScript-массива register_fields, который заполняется скриптом /dyn-mg/interface.js. Каждый элемент этого массива &mdash; это запись с полями:<ul>
<li>prompt &mdash; приглашение ко вводу параметра;</li>
<li>code &mdash; код параметра;</li>
<li>type &mdash; тип значения:<ul>
	<li>0 &mdash; обычная строка ввода;</li>
	<li>1 &mdash; выпадающий список;</li>
	<li>2 &mdash; большое поле ввода (textarea).</li>
</ul></li>
</ul></p>

<p>Исключениями являются поля с кодами:<ul>
<li>password &mdash; поле ввода пароля;</li>
<li>captcha &mdash; поле ввода капчи (пользователю надо показать картинку /auth/captcha?rnd=случайное_число");</li>
<li>offer &mdash; галочка, требующая согласиться с условиями пользовательского соглашения (пользователю надо дать ссылку на /offer).</li>
</ul></p>

<p>После того, как игрок заполнит все поля, необходимо сделать AJAX-вызов по адресу /player/register методом POST и передать ему в POST-параметрах значения всех параметров. code=значение, где code &mdash; это код параметра.</p>

<p>Сервер вернёт запись в формате JSON. Если у этой записи установлено поле error, то надо показать пользователю ошибку с этим текстом. Если установлено поле errors, то это индивидуальные сообщения об ошибках, относящиеся к полям формы. Сам errors &mdash; это запись, ключами которой являются коды полей:</p>
<pre class="doc-code-sample">
{
  errors: {
    captcha: "Введите цифры с картинки",
    email: "Введите ваш адрес e-mail",
    password: "Введите ваш пароль",
    name: "Недопустимые символы в имени. Можно использовать только цифры, латинские и русские буквы, цифры, пробелы, а также символы '_' и '-'",
    sex: "Сделайте верный выбор"
  },
  success: false
}
</pre>

<p>Если регистрация прошла успешно, то в результатах запроса будет установлено поле ok=1. Далее скрипт титульной страницы должен выполнить запрошенное сервером действие:<ul>
<li>если установлено поле session, то необходимо перенаправить браузер на страницу / методом POST и передать скрытый параметр session, равный в точности переданному session (это ID сеанса);</li>
<li>если установлено поле redirect, то необходимо просто перенаправить браузер на страницу с адресом из redirect.</li>
</ul></p>

<p>Посмотреть пример реализации, как это сделано в основном скрипте конструктора, вы можете в исходниках <a href="/doc/game-template/indexpage.js">indexpage.js</a>.</p>

<h1>Восстановление пароля</h1>

<p>Восстановление пароля &mdash; сейчас это просто переадресация на /auth/remind?redirect=/. Вы можете сразу спросить e-mail игрока, на который прислать данные восстановления, и отправить POST-запрос на /auth/remind с параметрами: redirect=/, email=..., ok=1.</p>

<h1>С чего начать</h1>

<p>Чтобы сделать хорошее качественное оформление титульной страницы, проще всего взять готовый шаблон из конструктора и доработать его. Возьмём, например, шаблон "Средневековье":</p>
<img class="doc-screenshot" src="/st/tutorial/indexpage-1.png" alt="" />
<p>Выберем тип размещения блоков на странице и загрузим картинку, которая послужит фоном:</p>
<img class="doc-screenshot" src="/st/tutorial/indexpage-2.png" alt="" />
<p>Затем нажмём на ссылку "установить" и посмотрим, что получилось на главной странице нашей игры:</p>
<img class="doc-screenshot" src="/st/tutorial/indexpage-3.jpg" alt="" />
<p>Слева на пустом месте будут новости, когда мы их подключим к игре. Давайте попробуем доработать этот шаблон. Для этого скачаем его себе на компьютер в виде ZIP-архива и распакуем:</p>
<ul>
	<li>base-image.jpg</li>
	<li>body-bg-1.jpg</li>
	<li>box-bottom.png</li>
	<li>box-left-bottom.png</li>
	<li>box-left.png</li>
	<li>box-left-top.png</li>
	<li>box-right-bottom.png</li>
	<li>box-right.png</li>
	<li>box-right-top.png</li>
	<li>box-top.png</li>
	<li>button.png</li>
	<li>index.css</li>
	<li>index.html</li>
</ul>
<p>Вёрстка располагается в index.html. Теперь можно её поправить. Давайте для примера поменяем местами содержимое колонок page-layout-2-left и page-layout-2-right. Теперь откроем index.css и поменяем стили каких-нибудь элементов. Скажем, цвет полей ввода. Допишем строчку:
<pre class="doc-code-sample">
#name, #password { background: #ff8080 }
</pre>
<p>Теперь необходимо запаковать все файлы в ZIP-архив и загрузить обратно в конструктор. Посмотрим, что получилось:</p>
<img class="doc-screenshot" src="/st/tutorial/indexpage-4.jpg" alt="" />

<p>Теперь вы можете изменять любые элементы оформления титульных страниц. Если вы хотите изменить оформление какого-то элемента, прежде всего вам понадобится узнать его id или class. Лучшее средство для этого &mdash; отладчик Firebug для браузера Firefox. Скачать его можно <a href="http://getfirebug.com/downloads">с официальной страницы</a>. Кроме того, прочтите <a href="/doc/design/firebug">нашу краткую инструкцию</a>, как пользоваться Firebug.</p>
