<!-- doc.title Настройка крафта в конструкторе онлайн-игр -->
<!-- doc.parent index -->
<!-- doc.keywords крафт, производство, рецепты, онлайн-игры -->
<!-- doc.description Описание, как конфигурировать систему крафта в конструкторе онлайн-игр -->

<h1>Система крафта</h1>

<p>Крафт &mdash; это переработка персонажами одних предметов в другие по рецептам, заданным администратором игры. Для каждого рецепта задаются условия, при которых этот рецепт виден игроку, при которых им можно пользоваться, какие ингредиенты нужны для производства рецепта, что должно получиться в итоге.</p>

<p>Чтобы подключить систему крафта к игре, необходимо <a href="/doc/modules">включить модуль</a> "Мирная деятельность" и зависимый от него "Крафт".</p>

<h1>Настройка крафта</h1>

<p>Первое, что необходимо сделать для настройки крафта, это создать разделы для рецептов. Это делается через меню "Мирная деятельность / Крафт / Разделы рецептов": <img class="doc-screenshot" src="/st/tutorial/crafting-1.png" alt="" /></p>

<p>Эти разделы будут отображаться в пользовательском интерфейсе в виде вкладок, на которых будут размещаться собственно рецепты. Каждый раздел настраивается при помощи формы: <img class="doc-screenshot" src="/st/tutorial/crafting-2.png" alt="" /></p>

<ul>
    <li>Название раздела &mdash; то, как он будет отображаться в интерфейсе;</li>
    <li>порядок сортировки &mdash; разделы будут сортироваться в порядке возрастания номеров.</li>
</ul>

<p>Сами рецепты настраиваются через интерфейс "Мирная деятельность / Крафт / Рецепты": <img class="doc-screenshot" src="/st/tutorial/crafting-3.png" alt="" /></p>

<p>Чтобы создать новый рецепт, необходимо нажать на ссылку "Новый рецепт" и заполнить форму свойств рецепта: <img class="doc-screenshot" src="/st/tutorial/crafting-4.png" alt="" /></p>

<ul>
    <li>Название рецепта &mdash; это заголовок, который будет написан в пользовательском интерфейсе;</li>
    <li>порядок сортировки &mdash; рецепты будут сортироваться в порядке возрастания номеров;</li>
    <li>условие видимости &mdash; <a href="/doc/script">скриптовое выражение</a>, позволяющее определить, может ли данный персонаж видеть данный рецепт. Если персонаж не видит рецепт, то он не может и использовать его. Но это не значит, что если рецепт виден, то он обязательно может быть использован;</li>
    <li>время изготовления &mdash; скриптовое выражение, рассчитывающее время изготовления рецепта в секундах данным персонажем. Обратите внимание, что если в результате вычисления выражения получится число, меньшее 30, то рецепт будет делаться ровно 30 секунд. Если число, большее суток (86400), то рецепт будет делаться сутки;</li>
    <li>изображение рецепта &mdash; это картинка, которая будет отображаться рядом с рецептом (автоматически конвертируется в 100x100);</li>
    <li>описание рецепта &mdash; текст, который будет показываться рядом с рецептом в пользовательском интерфейсе и в библиотеке;</li>
    <li>текст на прогресс-баре &mdash; это текст (скриптовый), который позволяет при использовании этого рецепта показать произвольный текст поверх прогресс-бара. Если поле оставлено пустым, то будет использоваться текст из глобальных настроек крафта.</li>
</ul>

<p>После того, как новый рецепт создан, открывается обзорный интерфейс по данному рецепту: <img class="doc-screenshot" src="/st/tutorial/crafting-5.png" alt="" /></p>

<p>Чтобы задать минимальные требования по навыкам персонажа для видимости и использования данного рецепта, можно воспользоваться специальным блоком "Минимальные требования". При нажатии на ссылку "Редактировать требования" открывается форма настроек требований: <img class="doc-screenshot" src="/st/tutorial/crafting-6.png" alt="" /></p>

<p>Здесь для каждого параметра персонажа можно указать два числа &mdash; видимость и доступность. Например, на скриншоте выше приведён пример, как настроить рецепт, чтобы он был виден всем персонажам с 3 уровня, но доступен был только с 4 уровня. Это полезно, чтобы мотивировать игроков к повышению уровня. Им уже на 3 уровне показывается бонус, который они получат, докачавшись до 4 уровня.</p>

<p>Условия доступности &mdash; это список произвольных условий, которые можно задать для рецепта, при которых он работает. Для добавления нового условия нажмите на ссылку "Новое условие". Откроется форма: <img class="doc-screenshot" src="/st/tutorial/crafting-7.png" alt="" /></p>

<p>К произвольному условию можно добавить комментарий, который будет показан игроку, если в данный момент условие ложно. На скриншоте выше приведён пример, как сделать рецепт, который работает только в локации с установленным признаком p_temple_cellar.</p>

<p>Список ингредиентов позволяет задать любое (в том числе и пустое) число ингредиентов, которые будут требоваться для производства рецепта. Для добавления нового ингредиента нажмите на ссылку "Новый ингредиент": <img class="doc-screenshot" src="/st/tutorial/crafting-8.png" alt="" /></p>

<ul>
    <li>тип предмета &mdash; это один из <a href="/doc/inventory">предметов</a>, существующих в игре;</li>
    <li>порядок сортировки &mdash; ингредиенты будут показываться в порядке возрастания номеров;</li>
    <li>сколько долей забрать &mdash; <a href="/doc/script">скриптовое выражение</a>, определяющее сколько долей предмета необходимо списать при использовании этого рецепта. Если предмет неделимый, то указывается количество полных предметов;</li>
    <li>предмет должен быть надет &mdash; это галочка, позволяющая задать износ инструмента в данном рецепте. Если прописать инструмент в качестве ингредиента и списывать 1 единицу после каждого использования рецепта, то получится реализация износа инструмента.</li>
</ul>

<p>Список продукции, которая выдаётся после использования рецепта, задаётся в разделе "Продукция". Для добавления нового продукта нажмите на ссылку "Новый продукт": <img class="doc-screenshot" src="/st/tutorial/crafting-9.png" alt="" /></p>

<ul>
    <li>тип предмета &mdash; это тип выдаваемого предмета;</li>
    <li>порядок сортировки &mdash; продукция будет показываться в порядке возрастания номеров;</li>
    <li>сколько предметов выдать &mdash; это количество, задаваемое в целых предметах (не в долях);</li>
    <li>переопределение параметров &mdash; это возможность выдавать в рецепте модифицированные предметы. Каждый параметр предмета можно задать в виде скриптового выражения, которое будет вычислено в момент выдачи продукции.</li>
</ul>

<p>Кроме выдачи продукции, можно также выдать персонажу опыт (например, опыт алхимии). Чтобы настроить выдачу опыта, нажмите на ссылку "Редактировать опыт": <img class="doc-screenshot" src="/st/tutorial/crafting-10.png" alt="" /></p>

<p>В форме перечислены все <a href="/doc/parameters">параметры персонажа</a>, сохраняемые в базе данных. Для каждого параметра можно задать скриптовое выражение, определяющее, сколько единиц данного параметра надо добавить персонажу после выполнения рецепта.</p>

<h1>Глобальные настройки крафта</h1>

<p>Форма глобальных настроек крафта доступна в меню "Мирная деятельность / Крафт / Настройки": <img class="doc-screenshot" src="/st/tutorial/crafting-11.png" alt="" /></p>

<ul>
    <li>Текст на прогресс-баре во время крафта &mdash; это текстовое скриптовое выражение, значение которого будет показываться поверх прогресс-бара во время крафта. Для каждого рецепта это значение может быть перекрыто его настройками;</li>
    <li>приоритет деятельности &mdash; это числовое значение, которое определяет приоритет занятости персонажа при занятии крафтом. Описание приоритетов деятельности приведено на странице "<a href="/doc/activities#priorities">Система деятельности персонажей</a>";</li>
    <li>сохранять статистику крафта с разбивкой по параметрам &mdash; это настройки системы логгирования крафта (описана в следующем разделе). Позволяет сохранять в базе данных статистику по частоте использования крафта различными уровнями персонажей. Например, если вам интересно, какие рецепты, в основном, крафтят новички, какие &mdash; середнячки, а какие &mdash; старички, то поставьте галочку напротив параметра персонажа "Уровень". И тогда в статистике будет видно, какие рецепты крафтят персонажи 1 уровня, какие &mdash; 2-го и т.д.</li>
</ul>

<h1>Статистика по крафту</h1>

<p>Первый отчёт ("Мирная деятельность / Крафт / Сводка по использованию рецептов") показывает суммарное количество использований того или иного рецепта персонажами по датам: <img class="doc-screenshot" src="/st/tutorial/crafting-12.png" alt="" /></p>

<p>Администратор устанавливает галочки напротив рецептов, которые его интересуют, и эти рецепты станут столбцами таблицы. Строками являются даты. Показывается статистика за последний год.</p>

<p>Второй отчёт ("Мирная деятельность / Крафт / Использование одного рецепта в разбивке по параметрам") позволяет получать данные по одному рецепту в разбивке по одному из настроенных параметров (см. предыдущий раздел): <img class="doc-screenshot" src="/st/tutorial/crafting-13.png" alt="" /></p>

<p>Колонками таблицы становятся значения выбранного параметра, а строками &mdash; даты. На скриншоте выше рецепт "Изготовление пробирки" использовался 19 ноября 2 раза персонажами с параметром test=20 и 1 раз персонажем с параметром test=35. 20 ноября рецепт использовался всего 1 раз персонажем с test=35.</p>

<h1>Дополнительно</h1>
<ul>
    <li><a href="/doc/script">Описание скриптового движка</a></li>
    <li><a href="/doc/activities">Описание деятельности персонажей</a></li>
</ul>
