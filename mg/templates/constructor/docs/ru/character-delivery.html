<!-- doc.title Доставка параметров персонажа в клиент игры -->
<!-- doc.parent index -->
<!-- doc.keywords персонаж, параметры, онлайн-игра -->
<!-- doc.description Информация о настройке доставки параметров персонажа в клиент онлайн-игры -->

<h1>Доставка параметров персонажей в клиент</h1>

<p>Обычно скриптовые выражения вычисляются на стороне сервера. Однако в некоторых случаях это необходимо производить на стороне клиента. Например, <a href="/doc/character-menu">контекстное меню персонажа</a> формируется прямо на клиенте. Также это относится к динамическим блокам в игровом интерфейсе.</p>

<p>Для того, чтобы клиент мог правильно вычислить значение выражения, использующего параметры персонажа, необходимо эти параметры своевременно ему доставить. Для этого существует два механизма:<ul>
    <li>доставка параметров персонажа, управляемого игроком (myparams);</li>
    <li>доставка параметров других персонажей, которые видны игроку на экране.</li>
</ul></p>

<h1>Доставка параметров персонажа, управляемого игроком</h1>

<p>Каждый раз, когда изменяется параметр персонажа, видимый его владельцу (см. раздел <a href="/doc/parameters">Параметры</a>), в клиент отправляется его новое значение. В браузере доступен глобальный объект Characters.myparams, который содержит имена параметров и их текущие значения в формате <a href="/doc/js-script#DynamicValue">DynamicValue</a>:</p>
<pre class="doc-code-sample">
Characters.myparams = {
    hp: DynamicValue(...),
    max_hp: DynamicValue(...),
    armor: DynamicValue(...),
    ...
};
</pre>

<p>Текущие мгновенные значения параметров можно получить при помощи функции Characters.myParam:</p>
<pre class="doc-code-sample">
var armor = Characters.myParam('armor');
</pre>

<h1>Доставка параметров других персонажей</h1>

<p>Как сказано в предыдущем разделе, в клиент доставляются все видимые личные параметры персонажа. Однако, если доставлять всем игрокам все параметры каждого персонажа, то объём трафика превысит все мыслимые пределы. В связи с чем, администратор должен выбрать, какие параметры чужих персонажей он хочет доставлять в клиент, а какие нет. Это делается через пункт меню "Персонажи / Доставка параметров в клиент": <img class="doc-screenshot" src="/st/tutorial/charcontext-3.png" alt="" /></p>

<p>Нажимая на ссылку "Новый параметр" или на "редактировать", администратор может получить доступ к редактору доставляемого параметра: admin <img class="doc-screenshot" src="/st/tutorial/charcontext-4.png" alt="" /></p>

<p>Здесь выбирается один из параметров персонажа, который будет доставлен в клиент. Системное ограничение на количество доставляемых параметров &mdash; не более 10.</p>

<h1>Дополнительно</h1>
<ul>
	<li><a href="/doc/script">Скриптовый движок</a></li>
	<li><a href="/doc/js-script">JavaScript API конструктора</a></li>
</ul>
